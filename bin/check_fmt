#!/bin/bash

# Checks if all project files are formatted using gofmt
#
# Usage:
#> bin/check_fmt

source bin/helpers/output.sh

unformatted=`find . \
    ! -path "\./vendor/*" \
    -type f \
    -iregex '.*\.go' \
    -exec gofmt -l '{}' \;
`
if [ ! -z "$unformatted" ]; then
    print_error "Following files are not formatted using gofmt:"
    echo "$unformatted"
    exit 1
fi

print_success "All files are formatted using gofmt."
exit 0